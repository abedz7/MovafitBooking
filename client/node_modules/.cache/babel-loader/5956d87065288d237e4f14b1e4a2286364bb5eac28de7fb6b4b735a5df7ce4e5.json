{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASUS ZEN BOOK\\\\Desktop\\\\MovafitBooking\\\\src\\\\contexts\\\\BookingContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport toast from 'react-hot-toast';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BookingContext = /*#__PURE__*/createContext();\nexport const useBooking = () => {\n  _s();\n  const context = useContext(BookingContext);\n  if (!context) {\n    throw new Error('useBooking must be used within a BookingProvider');\n  }\n  return context;\n};\n_s(useBooking, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const BookingProvider = ({\n  children\n}) => {\n  _s2();\n  const {\n    token\n  } = useAuth();\n  const [appointments, setAppointments] = useState([]);\n  const [packages, setPackages] = useState([]);\n  const [availableSlots, setAvailableSlots] = useState([]);\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    fetchPackages(); // Always fetch packages (no auth required)\n    if (token) {\n      fetchAppointments();\n    }\n  }, [token]);\n  const fetchAppointments = async () => {\n    try {\n      const response = await axios.get('/api/appointments/my-appointments', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setAppointments(response.data.data || []);\n    } catch (error) {\n      console.error('Error fetching appointments:', error);\n    }\n  };\n  const fetchPackages = async () => {\n    try {\n      const response = await axios.get('/api/packages');\n      setPackages(response.data.data || []);\n    } catch (error) {\n      console.error('Error fetching packages:', error);\n    }\n  };\n  const getAvailableSlots = async (date, gender) => {\n    try {\n      setLoading(true);\n      const response = await axios.get(`/api/appointments/available-slots`, {\n        params: {\n          date,\n          gender\n        }\n      });\n      setAvailableSlots(response.data.data || []);\n    } catch (error) {\n      toast.error('שגיאה בטעינת הזמנים הזמינים');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const bookAppointment = async bookingData => {\n    try {\n      setLoading(true);\n      const response = await axios.post('/api/appointments/book', bookingData, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setAppointments(prev => [...prev, response.data.data]);\n      toast.success('התור נקבע בהצלחה!');\n      return true;\n    } catch (error) {\n      var _error$response, _error$response$data;\n      const message = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'שגיאה בקביעת התור';\n      toast.error(message);\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const cancelAppointment = async appointmentId => {\n    try {\n      await axios.put(`/api/appointments/${appointmentId}/cancel`, {}, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setAppointments(prev => prev.filter(apt => apt._id !== appointmentId));\n      toast.success('התור בוטל בהצלחה');\n      return true;\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      const message = ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || 'שגיאה בביטול התור';\n      toast.error(message);\n      return false;\n    }\n  };\n  const rescheduleAppointment = async (appointmentId, newDate, newTime) => {\n    try {\n      const response = await axios.put(`/api/appointments/${appointmentId}/reschedule`, {\n        date: newDate,\n        time: newTime\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setAppointments(prev => prev.map(apt => apt._id === appointmentId ? response.data.data : apt));\n      toast.success('התור נדחה בהצלחה');\n      return true;\n    } catch (error) {\n      var _error$response3, _error$response3$data;\n      const message = ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message) || 'שגיאה בדחיית התור';\n      toast.error(message);\n      return false;\n    }\n  };\n  const purchasePackage = async packageId => {\n    try {\n      setLoading(true);\n      const response = await axios.post('/api/packages/purchase', {\n        packageId\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      toast.success('החבילה נרכשה בהצלחה!');\n      return true;\n    } catch (error) {\n      var _error$response4, _error$response4$data;\n      const message = ((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.message) || 'שגיאה ברכישת החבילה';\n      toast.error(message);\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const value = {\n    appointments,\n    packages,\n    availableSlots,\n    loading,\n    getAvailableSlots,\n    bookAppointment,\n    cancelAppointment,\n    rescheduleAppointment,\n    purchasePackage,\n    fetchAppointments,\n    fetchPackages\n  };\n  return /*#__PURE__*/_jsxDEV(BookingContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 155,\n    columnNumber: 5\n  }, this);\n};\n_s2(BookingProvider, \"fReQwT4+i1FIGKVd4p9PeqhVKtI=\", false, function () {\n  return [useAuth];\n});\n_c = BookingProvider;\nvar _c;\n$RefreshReg$(_c, \"BookingProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","axios","toast","useAuth","jsxDEV","_jsxDEV","BookingContext","useBooking","_s","context","Error","BookingProvider","children","_s2","token","appointments","setAppointments","packages","setPackages","availableSlots","setAvailableSlots","loading","setLoading","fetchPackages","fetchAppointments","response","get","headers","Authorization","data","error","console","getAvailableSlots","date","gender","params","bookAppointment","bookingData","post","prev","success","_error$response","_error$response$data","message","cancelAppointment","appointmentId","put","filter","apt","_id","_error$response2","_error$response2$data","rescheduleAppointment","newDate","newTime","time","map","_error$response3","_error$response3$data","purchasePackage","packageId","_error$response4","_error$response4$data","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/ASUS ZEN BOOK/Desktop/MovafitBooking/src/contexts/BookingContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst BookingContext = createContext();\r\n\r\nexport const useBooking = () => {\r\n  const context = useContext(BookingContext);\r\n  if (!context) {\r\n    throw new Error('useBooking must be used within a BookingProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const BookingProvider = ({ children }) => {\r\n  const { token } = useAuth();\r\n  const [appointments, setAppointments] = useState([]);\r\n  const [packages, setPackages] = useState([]);\r\n  const [availableSlots, setAvailableSlots] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchPackages(); // Always fetch packages (no auth required)\r\n    if (token) {\r\n      fetchAppointments();\r\n    }\r\n  }, [token]);\r\n\r\n  const fetchAppointments = async () => {\r\n    try {\r\n      const response = await axios.get('/api/appointments/my-appointments', {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      setAppointments(response.data.data || []);\r\n    } catch (error) {\r\n      console.error('Error fetching appointments:', error);\r\n    }\r\n  };\r\n\r\n  const fetchPackages = async () => {\r\n    try {\r\n      const response = await axios.get('/api/packages');\r\n      setPackages(response.data.data || []);\r\n    } catch (error) {\r\n      console.error('Error fetching packages:', error);\r\n    }\r\n  };\r\n\r\n  const getAvailableSlots = async (date, gender) => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axios.get(`/api/appointments/available-slots`, {\r\n        params: { date, gender }\r\n      });\r\n      setAvailableSlots(response.data.data || []);\r\n    } catch (error) {\r\n      toast.error('שגיאה בטעינת הזמנים הזמינים');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const bookAppointment = async (bookingData) => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axios.post('/api/appointments/book', bookingData, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      setAppointments(prev => [...prev, response.data.data]);\r\n      toast.success('התור נקבע בהצלחה!');\r\n      return true;\r\n    } catch (error) {\r\n      const message = error.response?.data?.message || 'שגיאה בקביעת התור';\r\n      toast.error(message);\r\n      return false;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const cancelAppointment = async (appointmentId) => {\r\n    try {\r\n      await axios.put(`/api/appointments/${appointmentId}/cancel`, {}, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      setAppointments(prev => prev.filter(apt => apt._id !== appointmentId));\r\n      toast.success('התור בוטל בהצלחה');\r\n      return true;\r\n    } catch (error) {\r\n      const message = error.response?.data?.message || 'שגיאה בביטול התור';\r\n      toast.error(message);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const rescheduleAppointment = async (appointmentId, newDate, newTime) => {\r\n    try {\r\n      const response = await axios.put(`/api/appointments/${appointmentId}/reschedule`, {\r\n        date: newDate,\r\n        time: newTime\r\n      }, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      setAppointments(prev => \r\n        prev.map(apt => \r\n          apt._id === appointmentId ? response.data.data : apt\r\n        )\r\n      );\r\n      toast.success('התור נדחה בהצלחה');\r\n      return true;\r\n    } catch (error) {\r\n      const message = error.response?.data?.message || 'שגיאה בדחיית התור';\r\n      toast.error(message);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const purchasePackage = async (packageId) => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axios.post('/api/packages/purchase', { packageId }, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      toast.success('החבילה נרכשה בהצלחה!');\r\n      return true;\r\n    } catch (error) {\r\n      const message = error.response?.data?.message || 'שגיאה ברכישת החבילה';\r\n      toast.error(message);\r\n      return false;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const value = {\r\n    appointments,\r\n    packages,\r\n    availableSlots,\r\n    loading,\r\n    getAvailableSlots,\r\n    bookAppointment,\r\n    cancelAppointment,\r\n    rescheduleAppointment,\r\n    purchasePackage,\r\n    fetchAppointments,\r\n    fetchPackages\r\n  };\r\n\r\n  return (\r\n    <BookingContext.Provider value={value}>\r\n      {children}\r\n    </BookingContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}